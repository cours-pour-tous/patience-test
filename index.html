<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ â€” ØªØ¬Ø±Ø¨Ø©</title>
  <style>
    /* ğŸ¨ ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© */
    :root{font-family: system-ui, Tahoma, Arial;}
    body{
      margin:0;
      background:#f7f7f7;
      color:#111;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
    }

    /* ğŸ§± ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©) */
    .card{
      width:min(980px,96vw);
      background:#fff;
      border-radius:12px;
      box-shadow:0 10px 40px rgba(2,6,23,0.08);
      padding:24px;
    }

    h1{margin:0 0 12px;font-size:22px}

    .lessons{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:12px;
    }

    .lesson{
      padding:12px;
      border-radius:10px;
      border:1px solid #eef2ff;
      background:linear-gradient(180deg,#fff,#fbfdff);
      cursor:pointer;
    }

    .lesson h3{margin:0 0 6px;font-size:16px}
    .lesson p{margin:0;font-size:13px;color:#555}

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      margin-top:18px;
    }

    button{
      padding:10px 14px;
      border-radius:8px;
      border:0;
      background:#0b5fff;
      color:white;
      font-weight:600;
      cursor:pointer;
    }

    button.secondary{background:#666}
    footer{margin-top:14px;font-size:12px;color:#666}

    /* ğŸ•¶ï¸ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ (ÙˆØ¶Ø¹ Ø§Ù„ØªØ¬Ø±Ø¨Ø©) */
    #blackout{
      position:fixed;
      inset:0;
      background:#000;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:9999;
    }
    #blackout.hide-cursor{cursor:none}
    #counter, #smallmsg, #resultArea { display:none; }
  </style>
</head>
<body>
  <div class="card" id="mainCard">
    <h1 id="siteTitle">Ù‚Ø§Ø¦Ù…Ø© Ø¯Ø±ÙˆØ³ â€” ÙƒØ§ÙØª Ø§Ù„Ø¯Ø±ÙˆØ³</h1>

    <!-- ğŸ“š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ -->
    <div class="lessons" id="lessonsList">
      <div class="lesson"><h3>Ø§Ù„Ø¯Ø±Ø³ 1 â€” Ù…Ù‚Ø¯Ù…Ø© Ø¹Ø§Ù…Ø©</h3><p>Ù…Ø¨Ø§Ø¯Ø¦ Ø£Ø³Ø§Ø³ÙŠØ© ÙˆÙ…Ù‚Ø¯Ù…Ø© Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹.</p></div>
      <div class="lesson"><h3>Ø§Ù„Ø¯Ø±Ø³ 2 â€” Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¹Ù…Ù„</h3><p>Ø´Ø±Ø­ Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.</p></div>
      <div class="lesson"><h3>Ø§Ù„Ø¯Ø±Ø³ 3 â€” Ø®Ø·ÙˆØ§Øª ØªÙ†ÙÙŠØ°ÙŠØ©</h3><p>Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©.</p></div>
      <div class="lesson"><h3>Ø§Ù„Ø¯Ø±Ø³ 4 â€” Ù†ØµØ§Ø¦Ø­ ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª</h3><p>Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©.</p></div>
    </div>

    <div class="controls">
      <button id="start">Ø§ÙØªØ­ Ø§Ù„Ø¯Ø±Ø³</button>
      <button id="reset" class="secondary">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    </div>

    <footer id="pageFooter"></footer>
  </div>

  <!-- ğŸ•¶ï¸ Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø·ÙØ§Ø¡ (Ø¹Ù†Ø¯Ù…Ø§ ØªØ¨Ø¯Ø£ Ø§Ù„ØªØ¬Ø±Ø¨Ø©) -->
  <div id="blackout" class="hide-cursor" aria-hidden="true">
    <div id="smallmsg" aria-hidden="true"></div>
    <div id="counter" aria-hidden="true">0</div>
  </div>

  <div id="resultArea" class="result" aria-hidden="true">
    <div id="resultText"></div>
  </div>

  <script>
  /****************************************************************
   * ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ÙƒÙˆØ¯:
   * - Ø¯Ø§Ù„Ø© playBeep(): ØªØ´ØºÙ‘Ù„ ØµÙˆØª "Ø¨ÙŠØ¨" Ø®ÙÙŠÙ Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„
   * - onUserAction(): ØªÙØ¶Ø§Ø¹Ù Ø§Ù„ÙˆÙ‚Øª ÙˆØªØ´ØºÙ‘Ù„ Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ ÙƒÙ„ ØªÙØ§Ø¹Ù„
   * - startBlackout(): ØªØ¨Ø¯Ø£ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¥Ø·ÙØ§Ø¡ (Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡)
   * - stopBlackout(): ØªÙÙ†Ù‡ÙŠ Ø§Ù„ØªØ¬Ø±Ø¨Ø©
   * - secretExitHandler(): ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø³Ø±ÙŠ (Ctrl + Q)
   * - tripleTouch: Ø®Ø±ÙˆØ¬ Ø³Ø±ÙŠ Ù„Ù„Ù‡Ø§ØªÙ (Ø«Ù„Ø§Ø« Ø£ØµØ§Ø¨Ø¹)
   ****************************************************************/

  (function(){
    const startBtn = document.getElementById('start');
    const resetBtn = document.getElementById('reset');
    const blackout = document.getElementById('blackout');

    let baseDuration = 30;  // â±ï¸ Ù…Ø¯Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    let remaining = baseDuration;
    let timer = null;
    let running = false;

    const TRIPLE_TOUCH_DURATION_MS = 2000;
    let tripleTouchTimer = null;

    /* ğŸµ Ø¯Ø§Ù„Ø© Ø§Ù„ØµÙÙŠØ± Ø§Ù„Ø®ÙÙŠÙ */
    function playBeep() {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = "sine";
        osc.frequency.value = 1000;   // ØªØ±Ø¯Ø¯ Ø§Ù„ØµÙˆØª (Ø­Ø¯Ø©)
        gain.gain.value = 0.3;        // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª (Ù‚ÙˆØ©)
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start();
        osc.stop(ctx.currentTime + 0.7); // Ù…Ø¯Ø© Ø§Ù„ØµÙÙŠØ±
      } catch (err) {
        console.warn("Audio not supported:", err);
      }
    }

    /* ğŸ§ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠÙÙØ¹Ù‘Ù„ Ø§Ù„ØµÙˆØª ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø© ÙÙ‚Ø· */
    document.addEventListener("click", () => {
      playBeep();
    }, { once: true });

    /* ğŸ–¥ï¸ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
    async function enterImmersiveMode() {
      try {
        if (document.documentElement.requestFullscreen) {
          await document.documentElement.requestFullscreen({ navigationUI: 'hide' });
        }
      } catch (e) {}
      try {
        if (blackout.requestPointerLock) blackout.requestPointerLock();
      } catch (e) {}
    }

    /* ğŸšª Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
    function exitImmersiveMode() {
      try { if (document.fullscreenElement) document.exitFullscreen(); } catch(e) {}
      try { if (document.exitPointerLock) document.exitPointerLock(); } catch(e) {}
    }

    /* ğŸ” Ø¹Ù†Ø¯ Ø£ÙŠ ØªÙØ§Ø¹Ù„ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
    function onUserAction(e) {
      if (!running) return;
      remaining *= 2;  // Ù…Ø¶Ø§Ø¹ÙØ© Ø§Ù„ÙˆÙ‚Øª ÙÙˆØ± Ø§Ù„ØªÙØ§Ø¹Ù„
      playBeep();      // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø®ÙÙŠÙ
    }

    /* ğŸ§© ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø³Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ */
    function attachDetectors() {
      ['mousemove','mousedown','keydown','touchstart','wheel'].forEach(evt=>{
        document.addEventListener(evt, onUserAction, { passive:true });
      });
      document.addEventListener('keydown', secretExitHandler);
      document.addEventListener('touchstart', tripleTouchStartHandler, { passive: true });
      document.addEventListener('touchend', tripleTouchEndHandler, { passive: true });
      document.addEventListener('contextmenu', preventDefaultIfRunning);
    }

    /* ğŸš« ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ */
    function detachDetectors() {
      ['mousemove','mousedown','keydown','touchstart','wheel'].forEach(evt=>{
        document.removeEventListener(evt, onUserAction);
      });
      document.removeEventListener('keydown', secretExitHandler);
      document.removeEventListener('touchstart', tripleTouchStartHandler);
      document.removeEventListener('touchend', tripleTouchEndHandler);
      document.removeEventListener('contextmenu', preventDefaultIfRunning);
    }

    /* âš ï¸ Ù…Ù†Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¨Ø§Ù„Ø²Ø± Ø§Ù„Ø£ÙŠÙ…Ù† Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ */
    function preventDefaultIfRunning(e){
      if (running) e.preventDefault();
    }

    /* ğŸ§  Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø³Ø±ÙŠ Ctrl + Q */
    function secretExitHandler(e) {
      if (e.ctrlKey && e.key && e.key.toLowerCase() === 'q') {
        e.preventDefault();
        stopBlackout(true);
      }
      const blocked = ['F11','F5','F12','Home','End','PageUp','PageDown'];
      if (blocked.includes(e.key)) {
        try { e.preventDefault(); } catch(ex) {}
      }
    }

    /* ğŸ“± Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ù„Ù‡Ø§ØªÙ Ø¨Ø«Ù„Ø§Ø« Ø£ØµØ§Ø¨Ø¹ Ù…Ø·ÙˆÙ‘Ù„Ø© */
    function tripleTouchStartHandler(e) {
      if (!running) return;
      if (e.touches && e.touches.length === 3) {
        clearTimeout(tripleTouchTimer);
        tripleTouchTimer = setTimeout(() => stopBlackout(true), TRIPLE_TOUCH_DURATION_MS);
      } else clearTimeout(tripleTouchTimer);
    }

    function tripleTouchEndHandler(e) {
      clearTimeout(tripleTouchTimer);
    }

    /* â–¶ï¸ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¬Ø±Ø¨Ø© */
    function startBlackout() {
      if (running) return;
      running = true;
      blackout.style.display = 'flex';
      remaining = baseDuration;
      attachDetectors();
      enterImmersiveMode();

      clearInterval(timer);
      timer = setInterval(()=>{
        remaining--;
        if (remaining <= 0) {
          clearInterval(timer);
          stopBlackout(false);
        }
      }, 1000);
    }

    /* â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ¬Ø±Ø¨Ø© */
    function stopBlackout(forced=false) {
      running = false;
      blackout.style.display = 'none';
      detachDetectors();
      exitImmersiveMode();
      clearInterval(timer);
      clearTimeout(tripleTouchTimer);
    }

    /* ğŸ–±ï¸ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    startBtn.addEventListener('click', startBlackout);
    document.querySelectorAll('.lesson').forEach(el => el.addEventListener('click', startBlackout));

    resetBtn.addEventListener('click', ()=>{
      const card = document.getElementById('mainCard');
      card.animate([{opacity:0.7},{opacity:1}], { duration: 300 });
    });
  })();
  </script>
</body>
</html>
